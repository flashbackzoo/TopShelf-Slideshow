(function(a){a.fn.tsSlideshow=function(b){var c=a.extend({transition:"horizontal",transitionSpeed:250,autoAdvance:false,autoAdvanceSpeed:1000,loop:false,scroll:false},b);return this.each(function(){var j={container:this,settings:c,panelsWrapper:g(a(this).find("[data-ui='slideshow-panelsWrapper']"),this),panels:g(a(this).find("[data-ui='slideshow-panel']"),this),markers:g(a(this).find("[data-ui='slideshow-marker']"),this),backButtons:g(a(this).find("[data-ui='slideshow-back']"),this),forwardButtons:g(a(this).find("[data-ui='slideshow-forward']"),this)};function g(p,o){var n=0,m=p.length,q=[];for(n=0;n<m;n+=1){if(a(p[n]).closest("[data-ui='slideshow']")[0]===o){q[q.length]=p[n]}}return q}var d=function(){var l={};(function(){l.tranOut=function(m){if(a(m.incoming).outerHeight()>a(m.outgoing).outerHeight()){a(j.panelsWrapper).css("height",a(m.incoming).outerHeight())}a(m.outgoing).removeClass("current");if(m.direction==="forward"){a(m.outgoing).animate({left:"-100%","margin-left":0},j.settings.transitionSpeed)}else{a(m.outgoing).animate({left:"100%","margin-left":0},j.settings.transitionSpeed)}};l.tranIn=function(m){a(m.incoming).animate({left:"50%","margin-left":"-"+(a(m.incoming).outerWidth()/2)+"px"},j.settings.transitionSpeed,function(){a(m.incoming).prevAll().css({left:"-100%"});a(m.incoming).nextAll().css({left:"100%"});if(a(m.incoming).outerHeight()<a(m.outgoing).outerHeight()){a(j.panelsWrapper).css("height",a(m.incoming).outerHeight())}a(m.incoming).addClass("current")})};l.restart=function(m){if(m.direction==="forward"){a(m.incoming).css({left:"100%"})}else{a(m.incoming).css({left:"-100%"})}};l.init=function(){var n=0,m=j.panels.length;for(n=1;n<m;n+=1){a(j.panels[n]).css({left:"100%"})}}})();return l};var f=function(){var l={};(function(){l.tranOut=function(m){a(m.outgoing).removeClass("current");if(m.direction==="forward"){a(m.outgoing).animate({top:"-100%","margin-top":0},j.settings.transitionSpeed)}else{a(m.outgoing).animate({top:"100%","margin-top":0},j.settings.transitionSpeed)}};l.tranIn=function(m){a(m.incoming).animate({top:"50%","margin-top":"-"+(a(m.incoming).outerHeight()/2)+"px"},j.settings.transitionSpeed,function(){a(m.incoming).prevAll().css({top:"-100%"});a(m.incoming).nextAll().css({top:"100%"});if(a(m.incoming).outerHeight()<a(m.outgoing).outerHeight()){a(j.panelsWrapper).css("height",a(m.incoming).outerHeight())}a(m.incoming).addClass("current")})};l.restart=function(m){if(m.direction==="forward"){a(m.incoming).css({top:"100%","margin-top":(a(m.incoming).outerHeight()/2)+"px"})}else{a(m.incoming).css({top:"-100%","margin-top":"-"+(a(m.incoming).outerHeight()/2)+"px"})}};l.init=function(){var n=0,m=j.panels.length;for(n=1;n<m;n+=1){a(j.panels[n]).css({top:"100%"})}}})();return l};var k=function(){var l={};(function(){l.tranIn=function(n){var m=a(n.incoming).outerHeight(true);a(n.incoming).fadeIn(j.settings.transitionSpeed,function(){a(n.incoming).addClass("current")});if(m<a(n.outgoing).height()){a(j.panelsWrapper).css("height",m)}};l.tranOut=function(n){var m=a(n.incoming).outerHeight(true);if(m>a(n.outgoing).height()){a(j.panelsWrapper).css("height",m)}a(n.outgoing).removeClass("current");a(n.outgoing).fadeOut(j.settings.transitionSpeed)};l.init=function(){for(i=1;i<j.panels.length;i+=1){a(j.panels[i]).hide()}}})();return l};var e=function(l){var m={};(function(){m.step=function(p){var q={};var r="";q.outgoing=g(a(j.container).find("[data-ui='slideshow-panel'].current"),j.container);if(q.outgoing.length){if(p==="back"){q.incoming=g(a(j.container).find("[data-ui='slideshow-panel'].current").prev(),j.container),q.direction="back"}else{q.incoming=g(a(j.container).find("[data-ui='slideshow-panel'].current").next(),j.container),q.direction="forward"}if(q.incoming.length){r=a(j.panels).index(q.incoming[0]);l.tranOut(q);l.tranIn(q);a(j.markers).removeClass("current");a(j.markers[r]).addClass("current")}else{if(j.settings.loop===true){if(p==="back"){prevMarker=a(j.markers[j.markers.length-1]);q.incoming=a(j.panels[j.panels.length-1])}else{nextMarker=a(j.markers[0]);q.incoming=a(j.panels[0])}try{l.restart(q)}catch(n){}l.tranOut(q);l.tranIn(q);a(j.markers).removeClass("current");if(p==="back"){a(prevMarker).addClass("current")}else{a(j.markers[0]).addClass("current")}}}}};m.jumpTo=function(s){var t={};t.outgoing=g(a(j.container).find("[data-ui='slideshow-panel'].current"),j.container),t.incoming=a(s),t.direction="back";var q=0,r=a(t.outgoing).nextAll(),n=r.length,u=a(j.panels).index(t.incoming);if(t.outgoing.length){for(q=0;q<n;q+=1){if(r[q]===t.incoming[0]){t.direction="forward"}}l.tranOut(t);l.tranIn(t);a(j.markers).removeClass("current");a(j.markers[u]).addClass("current")}}})();return m};var h=function(m){var l={};(function(){l.markers=function(){var n=j.markers.length;if(n>0){for(i=0;i<n;i+=1){(function(o){a(j.markers[o]).bind("click",function(p){p.preventDefault();if(!a(this).hasClass("current")){m.jumpTo(j.panels[o])}})}(i))}}};l.steps=function(){a(j.backButtons).bind("click",function(n){n.preventDefault();m.step("back")});a(j.forwardButtons).bind("click",function(n){n.preventDefault();m.step("forward")})};l.scroll=function(){a(j.container).bind("mousewheel",function(n){if(n.originalEvent.wheelDelta<0){n.preventDefault();m.step("forward")}else{n.preventDefault();m.step("back")}})}})();return l};(function(){switch(j.settings.transition){case"fade":var m=k(j);break;case"vertical":var m=f(j);break;default:var m=d(j);break}var n=e(m);var l=h(n);var o=a(j.panels[0]).outerHeight(true);l.steps();l.markers();if(j.settings.scroll===true){l.scroll()}m.init();if(j.settings.autoAdvance===true){(function(){var p=function(){n.step("forward")};setInterval(p,j.settings.autoAdvanceSpeed)})()}a(j.panels[0]).addClass("current");a(j.markers[0]).addClass("current");a(j.panelsWrapper).css("height",o)})()})}})(jQuery);